Description: CVE-2020-36277
    denial of service (application crash) via an incorrect left
    shift in pixConvert2To8 in pixconv.c
Index: leptonlib-1.79.0/src/sel1.c
===================================================================
--- leptonlib-1.79.0.orig/src/sel1.c	2021-03-30 13:16:17.908195390 +0200
+++ leptonlib-1.79.0/src/sel1.c	2021-03-30 13:16:17.900195211 +0200
@@ -1418,7 +1418,7 @@
 SEL  *
 selReadStream(FILE  *fp)
 {
-char    *selname;
+char     selname[256];
 char     linebuf[256];
 l_int32  sy, sx, cy, cx, i, j, version, ignore;
 SEL     *sel;
@@ -1435,17 +1435,14 @@
 
     if (fgets(linebuf, sizeof(linebuf), fp) == NULL)
         return (SEL *)ERROR_PTR("error reading into linebuf", procName, NULL);
-    selname = stringNew(linebuf);
     sscanf(linebuf, "  ------  %200s  ------", selname);
 
     if (fscanf(fp, "  sy = %d, sx = %d, cy = %d, cx = %d\n",
             &sy, &sx, &cy, &cx) != 4) {
-        LEPT_FREE(selname);
         return (SEL *)ERROR_PTR("dimensions not read", procName, NULL);
     }
 
     if ((sel = selCreate(sy, sx, selname)) == NULL) {
-        LEPT_FREE(selname);
         return (SEL *)ERROR_PTR("sel not made", procName, NULL);
     }
     selSetOrigin(sel, cy, cx);
@@ -1458,7 +1455,6 @@
     }
     ignore = fscanf(fp, "\n");
 
-    LEPT_FREE(selname);
     return sel;
 }
 
